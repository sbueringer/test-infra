var __generator=this&&this.__generator||function(e,t){var r,n,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function l(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},__values=this&&this.__values||function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}},__read=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(a)throw a.error}}return s};!function(){"use strict";function e(e,t,r){return"/spyglass/lens/"+e+"/"+r+"?"+function n(e,t){var r={artifacts:lensArtifacts[t],index:t,src:src};return"req="+encodeURIComponent(JSON.stringify(r))}(0,t)}function t(){var e,t,r=location.hash.substr(1).split(";"),n={};try{for(var a=__values(r),o=a.next();!o.done;o=a.next()){var s=o.value;if(""!==s){var i=__read(s.split(":"),2);n[i[0]]="#"+unescape(i[1])}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return n}function r(e){return{body:e,method:"POST",headers:{"X-CSRF-Token":csrfToken},credentials:"same-origin"}}window.addEventListener("message",function(n){return void 0,void 0,o=function(){var a,o,s,i,l,c,u,f,d,y,h,p,v,m,b;return __generator(this,function(w){switch(w.label){case 0:if(!function g(e){return"number"==typeof e.id&&e.message&&"string"==typeof e.message.type}(a=n.data))return[3,14];switch(o=a.id,s=a.message,i=function x(e){var t,r;try{for(var n=__values(Array.from(document.querySelectorAll("iframe"))),a=n.next();!a.done;a=n.next()){var o=a.value;if(o.contentWindow===e.source)return o}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}throw new Error("MessageEvent from unknown frame!?")}(n),l=i.dataset.lensName,c=Number(i.dataset.lensIndex),u=function(e){i.contentWindow.postMessage({id:o,message:{type:"response",data:e}},"*")},s.type){case"contentUpdated":return[3,1];case"request":return[3,2];case"requestPage":return[3,5];case"updatePage":return[3,8];case"updateHash":return[3,11];case"showOffset":return[3,12]}return[3,13];case 1:return i.style.height=s.height+"px",i.style.visibility="visible",i.dataset.hideTitle&&i.parentElement.parentElement.classList.add("hidden-title"),document.querySelector("#"+l+"-loading").style.display="none",u(""),[3,14];case 2:return[4,fetch(e(l,c,"callback"),r(s.data))];case 3:return h=w.sent(),f=u,[4,h.text()];case 4:return f.apply(void 0,[w.sent()]),[3,14];case 5:return[4,fetch(e(l,c,"rerender"),r(s.data))];case 6:return h=w.sent(),d=u,[4,h.text()];case 7:return d.apply(void 0,[w.sent()]),[3,14];case 8:return y=document.querySelector("#"+l+"-loading"),i.style.visibility="visible",y.style.display="block",[4,fetch(e(l,c,"rerender"),r(s.data))];case 9:return h=w.sent(),p=u,[4,h.text()];case 10:return p.apply(void 0,[w.sent()]),[3,14];case 11:return function _(e,r){var n=t();""!==r?n[e]=r:delete n[e],location.hash=function a(e){return Object.keys(e).map(function(t){return t+":"+escape(e[t].substr(1))}).join(";")}(n)}(c,s.hash),u(""),[3,14];case 12:for(v=document.getElementsByTagName("main")[0],m={left:0,top:0},b=i;b&&(m.top+=b.offsetTop,m.left+=b.offsetLeft,b.offsetParent instanceof HTMLElement&&b.offsetParent!==v);)b=b.offsetParent;return b||console.error("Couldn't find parent for frame!",v,i),v.scrollTop=m.top+s.top,v.scrollLeft=m.left+s.left,[3,14];case 13:return console.warn('Unrecognised message type "'+s.type+'" from lens "'+l+'":',a),[3,14];case 14:return[2]}})},new((a=void 0)||(a=Promise))(function(e,t){function r(e){try{s(o.next(e))}catch(e){t(e)}}function n(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(r,n)}s((o=o.apply(void 0,[])).next())});var a,o}),window.addEventListener("hashchange",function(e){var r,n,a=t();try{for(var o=__values(Object.keys(a)),s=o.next();!s.done;s=o.next()){var i=s.value,l=document.querySelector("#iframe-"+i);l&&l.contentWindow&&l.contentWindow.postMessage({type:"hashUpdate",hash:a[i]},"*")}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}),window.addEventListener("load",function(){!function r(){var r,n,a=t();try{for(var o=__values(lensIndexes),s=o.next();!s.done;s=o.next()){var i=s.value,l=document.querySelector("#iframe-"+i),c=e(l.dataset.lensName,Number(l.dataset.lensIndex),"iframe");c+="&topURL="+escape(location.href.split("#")[0])+"&lensIndex="+i;var u=a[i];u&&(c+=u),l.src=c}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}()})}();